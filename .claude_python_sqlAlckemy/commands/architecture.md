# /architecture - 製造業システムアーキテクチャ設計コマンド

## 目的
o3 MCPの製造システムアーキテクトとして、MCPプロトコルによる製造業外部システム連携能力を活用し、大規模製造業システムアーキテクチャ設計・IoT統合・MES/ERP連携を実行します。

## 対象AI
- **o3 MCP**: MCPプロトコル連携、リアルタイム製造システム構成変更、複雑IoT統合設計能力を活用

## 入力パラメータ
- **必須**: `$ARCHITECTURE_TYPE` - アーキテクチャタイプ（manufacturing_system, iot_integration, plc_interface, mes_integration, scada_connection）
- **任意**: `$PRODUCTION_SCALE` - 生産規模（small_factory, medium_plant, large_enterprise, multi_site）
- **任意**: `$INTEGRATION_SCOPE` - 統合範囲（shop_floor, plant_wide, enterprise_wide, supply_chain）
- **任意**: `$PERFORMANCE_TARGET` - パフォーマンス目標（standard, high_throughput, real_time_control, batch_processing）

## 出力
- **製造アーキテクチャ設計書**: `.tmp/manufacturing_architecture_[timestamp].md`
- **システム構成図**: `.tmp/manufacturing_diagrams/`
- **IoT統合仕様書**: `.tmp/iot_integration_specs.md`
- **実装ガイド**: `.tmp/manufacturing_implementation_guide.md`
- **移行計画書**: `.tmp/manufacturing_migration_plan.md`

## ワークフロー

### Phase 1: 製造業要件分析・制約調査
```markdown
## 製造業要件分析フェーズ

### 1. 生産・製造要件分析
- 生産プロセス・フロー要件の詳細化
- 品質管理・トレーサビリティ要件
- 生産能力・スループット要件
- リアルタイム制御・監視要件

### 2. 製造業制約・規制調査
- 既存MES・ERP・SCADA制約
- 工場設備・PLC・センサー制約
- 安全規制・環境規制・コンプライアンス制約
- 製造業標準（ISA-95、ISA-88）制約

### 3. 製造業外部システム・依存関係調査
- 既存MES・ERP・WMS・QMS調査
- PLC・SCADA・DCS統合ポイント
- IoTセンサー・エッジデバイス連携
- サプライチェーン・ベンダーシステム制約

### 4. 製造業品質属性・トレードオフ分析
- リアルタイム性 vs. データ一貫性
- 可用性 vs. 保守性
- セキュリティ vs. 運用性
- スケーラビリティ vs. 複雑性
```

### Phase 2: 製造業アーキテクチャ設計
```markdown
## 製造業アーキテクチャ設計フェーズ

### 1. 製造業論理アーキテクチャ設計
- 製造ドメイン分析・境界定義（生産、品質、保守、物流）
- 製造業コンポーネント・モジュール設計
- ISA-95準拠レイヤー・階層構造設計
- 製造データフロー・制御フロー設計

### 2. 製造業物理アーキテクチャ設計
- 工場・ライン・設備配置・ネットワーク構成
- サーバー・エッジデバイス・インフラ構成
- 製造データベース・データレイク設計
- 負荷分散・冗長化・可用性設計

### 3. 製造業統合アーキテクチャ設計
- MES・ERP・API・メッセージング設計
- IoTデータ統合・ETL・ストリーミング設計
- 製造業セキュリティ・認証認可設計
- 監視・ログ・運用・メンテナンス設計

### 4. 製造業技術選定・評価
- 製造業フレームワーク・ライブラリ選定
- 製造データベース・時系列DB選定
- IoTプラットフォーム・エッジコンピューティング選定
- 製造業開発・運用ツール選定
```

### Phase 3: 製造業詳細設計・実装指針
```markdown
## 製造業詳細設計フェーズ

### 1. 製造業コンポーネント詳細設計
- 製造業インターフェース・API詳細仕様
- 製造データモデル・スキーマ設計
- 生産ロジック・品質アルゴリズム設計
- 製造エラーハンドリング・例外処理設計

### 2. 製造データアーキテクチャ設計
- 製造データモデル・正規化設計
- 生産データフロー・バッチ処理設計
- データ品質・ガバナンス・トレーサビリティ設計
- バックアップ・災害復旧・事業継続設計

### 3. 製造業セキュリティアーキテクチャ設計
- 製造業認証・認可・アクセス制御
- 製造データ暗号化・OT/IT通信セキュリティ
- 産業制御システム脅威分析・セキュリティ対策
- コンプライアンス・監査対応・インシデント対応

### 4. 製造業運用アーキテクチャ設計
- 生産監視・メトリクス・アラート設計
- 製造ログ管理・分析基盤設計
- デプロイ・リリース戦略・ダウンタイム最小化設計
- 障害対応・復旧手順・メンテナンス設計
```

## 製造業アーキテクチャタイプ別仕様

### 1. 製造システム設計（manufacturing_system）
```yaml
目的: 統合製造システムアーキテクチャの設計・最適化
成果物:
  - 製造システム全体アーキテクチャ図
  - 生産コンポーネント設計書
  - 製造データフロー図
  - 製造業技術選定・評価書
設計要素:
  - ISA-95準拠論理・物理アーキテクチャ
  - 製造システム境界・インターフェース
  - 生産品質属性・非機能要件
  - 製造業技術スタック・プラットフォーム選定
```

### 2. IoT統合（iot_integration）
```yaml
目的: IoTセンサー・エッジデバイス統合アーキテクチャ設計
成果物:
  - IoTアーキテクチャ図
  - センサーデータ収集・処理設計
  - エッジコンピューティング戦略
  - IoTセキュリティ・運用戦略
設計要素:
  - IoTデバイス管理・プロビジョニング
  - センサーデータストリーミング・処理
  - エッジ・クラウド・ハイブリッド戦略
  - IoTセキュリティ・デバイス認証
```

### 3. PLC統合（plc_interface）
```yaml
目的: PLC・制御システムとの統合設計
成果物:
  - PLC統合アーキテクチャ図
  - 制御システム通信仕様
  - リアルタイムデータ処理設計
  - 制御システムセキュリティ戦略
設計要素:
  - PLC通信プロトコル（Modbus、EtherNet/IP、Profinet）
  - リアルタイムデータ収集・制御
  - 制御システム冗長化・可用性
  - OTセキュリティ・分離・監視
```

### 4. MES統合（mes_integration）
```yaml
目的: MES（製造実行システム）統合・連携設計
成果物:
  - MES統合アーキテクチャ図
  - 製造実行データ統合仕様
  - ワークフロー・オーケストレーション設計
  - MES運用・保守計画
設計要素:
  - MES機能（生産管理、品質管理、トレーサビリティ）
  - ERP・WMS・QMS統合パターン
  - 製造実行ワークフロー・承認プロセス
  - 製造実行データ・KPI・レポート
```

### 5. SCADA接続（scada_connection）
```yaml
目的: SCADA・DCS（分散制御システム）接続設計
成果物:
  - SCADA統合アーキテクチャ図
  - 監視制御データ統合仕様
  - HMI・オペレーター機能設計
  - SCADA運用・監視計画
設計要素:
  - SCADA通信・データ収集
  - HMI・アラーム・トレンド・レポート
  - 分散制御・プロセス自動化
  - SCADA冗長化・障害対応
```

## 成果物テンプレート

### 製造業システムアーキテクチャ設計書構成
```markdown
# 製造業システムアーキテクチャ設計書

## エグゼクティブサマリー
- 製造アーキテクチャ概要・主要特徴
- 製造業ビジネス価値・技術的利点
- 主要な設計決定・トレードオフ
- 実装・移行コスト・期間

## 製造業ビジネス要件・制約
### 製造業ビジネス要件
- 生産機能要件・ユースケース
- 品質・トレーサビリティ・コンプライアンス要件
- リアルタイム制御・監視・アラート要件
- 製造業標準・規制要件（ISA-95、ISO、FDA、GMP）

### 製造業制約・前提条件
- 製造技術的制約・既存システム制約
- 工場設備・安全・環境制約
- 予算・リソース・スケジュール制約
- 組織・プロセス・スキル制約

## 製造業アーキテクチャ概要
### 製造業論理アーキテクチャ
```
[製造システム全体図 - ISA-95準拠レイヤー構成]

製造業主要コンポーネント:
- Level 4: Business Planning & Logistics (ERP統合)
- Level 3: Manufacturing Operations Management (MES)
- Level 2: Supervisory Control (SCADA/HMI)
- Level 1: Basic Control (PLC/DCS)
- Level 0: Production Process (センサー・アクチュエータ)
```

### 製造業物理アーキテクチャ
```
[製造デプロイメント図 - 工場・ライン・設備構成]

製造インフラ構成:
- Enterprise Network: ERP・MES・データセンター
- Plant Network: SCADA・エンジニアリングワークステーション
- Control Network: PLC・DCS・HMI
- Device Network: センサー・アクチュエータ・フィールドデバイス
- IoT Edge: エッジゲートウェイ・コンピューティング
```

## 製造業詳細設計
### 製造業コンポーネント設計
#### [製造コンポーネント名]
- **目的・責務**: [製造コンポーネントの役割・責任範囲]
- **インターフェース**: [製造API・プロトコル仕様]
- **依存関係**: [他製造コンポーネント・外部システムとの関係]
- **データモデル**: [扱う製造データ・エンティティ]
- **品質属性**: [リアルタイム性・可用性・安全性要件]

### 製造データアーキテクチャ
#### 製造データモデル設計
- 製造エンティティ関係図（製造ER図）
- 製造データベーススキーマ設計
- 時系列データ・インデックス・パーティション戦略
- 製造データライフサイクル・アーカイブ戦略

#### 製造データフロー設計
- 生産バッチ処理・リアルタイム処理・ETLフロー
- IoTセンサーデータストリーミング処理
- 製造データ同期・レプリケーション
- 製造データ品質・バリデーション・クレンジング

### 製造業セキュリティアーキテクチャ
#### 製造業認証・認可
- 製造業認証方式（Active Directory・LDAP・証明書認証）
- 製造業認可モデル（役割ベース・属性ベース）
- 製造業シングルサインオン（SSO）
- 製造業多要素認証（MFA）・生体認証

#### 製造データ保護
- 製造データ暗号化（保存時・転送時）
- 製造業個人情報保護・営業秘密保護
- 製造アクセスログ・監査証跡・コンプライアンス
- 製造データ漏洩防止（DLP）・情報セキュリティ

## 製造業技術選定・評価
### 製造業技術スタック
| 層 | 技術 | 選定理由 | 代替案 |
|---|------|----------|--------|
| Manufacturing Execution | MES Platform | 製造実行・トレーサビリティ | Wonderware・Historian |
| Application Backend | FastAPI | 高性能API・非同期処理 | Django・Flask |
| Database | PostgreSQL + TimescaleDB | ACID・時系列データ | InfluxDB・MongoDB |
| Message Queue | Apache Kafka | 高スループット・耐障害性 | RabbitMQ・Redis Streams |
| IoT Platform | AWS IoT Core | スケーラビリティ・セキュリティ | Azure IoT・Google Cloud IoT |
| Edge Computing | AWS IoT Greengrass | エッジ処理・オフライン対応 | Azure IoT Edge・OpenEdge |

### 製造業評価基準・比較
- リアルタイム性・スループット・レイテンシ
- 製造業標準準拠・相互運用性
- 可用性・耐障害性・災害復旧
- セキュリティ・コンプライアンス・監査
- 開発・運用・保守・ライセンスコスト

## 製造業品質・リスク分析
### 製造業品質属性分析
#### リアルタイム性・パフォーマンス
- 制御応答時間目標: PLC制御 < 10ms, SCADA監視 < 100ms
- データ収集頻度: センサーデータ 1Hz, 生産データ 10秒間隔
- 同時接続数: IoTデバイス 10,000台, 操作員端末 100台
- リソース使用率: CPU < 70%, Memory < 80%, Network < 60%

#### 可用性・信頼性
- 稼働率目標: 99.9% (月間停止時間 < 43分)
- 障害復旧時間: MTTR < 15分
- データ整合性・耐障害性・冗長化
- 災害復旧・事業継続・バックアップ戦略

### 製造業リスク分析・緩和策
#### 製造業技術リスク
1. **IoT統合リスク**
   - 影響: データ収集不能・生産停止
   - 確率: Medium
   - 緩和策: エッジデバイス冗長化・オフライン対応・段階導入

2. **リアルタイム制御リスク**
   - 影響: 制御遅延・品質不良・安全リスク
   - 確率: High
   - 緩和策: 専用ネットワーク・優先制御・フェイルセーフ

#### 製造業運用リスク
1. **運用複雑性リスク**
   - 影響: 運用コスト増・障害対応遅延
   - 確率: High
   - 緩和策: 自動化・監視強化・運用手順標準化

## 製造業実装・移行計画
### 製造業実装フェーズ
#### Phase 1: 製造インフラ・基盤構築（2-3ヶ月）
- 製造ネットワーク・セキュリティ基盤構築
- 製造データベース・時系列DB構築
- 製造CI/CD パイプライン構築
- 製造監視・ログ基盤構築

#### Phase 2: 製造コア機能実装（3-6ヶ月）
- 生産管理・ワークオーダー機能
- 品質管理・検査・トレーサビリティ機能
- 在庫管理・部品・材料管理機能
- IoT・センサーデータ収集機能

#### Phase 3: 製造高度機能・最適化（3-4ヶ月）
- MES・ERP統合機能
- 予測保全・AI品質予測機能
- 製造パフォーマンス最適化
- 製造セキュリティ・コンプライアンス強化

### 製造業移行戦略
- 段階的移行（ライン別・工程別） vs. 一括移行
- 製造データ移行・同期戦略
- 製造システム並行運用・切り替え計画
- ロールバック・緊急対応計画

## 製造業運用・保守
### 製造業監視・運用
- 製造システム監視・アラート設定
- 生産パフォーマンス監視・KPIレポート
- 製造ログ管理・分析・トラブルシューティング
- 定期メンテナンス・予防保全・バックアップ

### 製造業保守・改善
- 製造技術的負債管理
- 製造セキュリティパッチ・更新
- 製造機能追加・変更対応
- 製造システム廃止・終了計画
```

## 連携コマンド
- **← /product-plan**: 製造プロダクト要件に基づくアーキテクチャ設計
- **→ /devops**: 製造アーキテクチャに基づくインフラ・運用設計
- **→ /security**: 製造セキュリティアーキテクチャの詳細化  
- **→ /design**: 製造アーキテクチャ制約を反映した詳細設計

## 品質チェックリスト
- [ ] 製造業ビジネス要件・非機能要件の適切な反映
- [ ] 製造業拡張性・保守性・可用性の考慮
- [ ] 製造業セキュリティ・コンプライアンス要件の満足
- [ ] 製造業技術選定の妥当性・リスク評価
- [ ] 製造業実装・運用の現実性・コスト妥当性

## 使用例

### 大規模製造システム設計
```bash
/architecture manufacturing_system --production_scale="large_enterprise" --integration_scope="enterprise_wide" --performance_target="high_throughput"
```

### IoT統合アーキテクチャ
```bash
/architecture iot_integration --production_scale="medium_plant" --integration_scope="plant_wide" --performance_target="real_time_control"
```

### MES統合設計
```bash
/architecture mes_integration --production_scale="multi_site" --integration_scope="enterprise_wide" --performance_target="batch_processing"
```