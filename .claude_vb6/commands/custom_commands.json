{
  "commands": [
    {
      "name": "/vb6-help",
      "description": "VB6カスタムコマンドのヘルプと.claude認識状態を確認",
      "pattern": "/vb6-help",
      "action": "1. 利用可能なVB6コマンド一覧を表示\n2. .claudeフォルダの認識状態を確認\n3. カスタムコマンドの読み込み状態を表示\n4. トラブルシューティング情報を提供"
    },
    {
      "name": "/vb6-analyze-code",
      "description": "VB6コードの静的解析を実行 - 複雑度、品質メトリクス、技術的負債の測定",
      "pattern": "/vb6-analyze-code <project_path>",
      "parameters": {
        "project_path": "VB6プロジェクトのパス",
        "options": "--metrics, --unused-code, --globals, --complexity"
      },
      "action": "1. プロジェクト内の全ファイルを走査\n2. コードメトリクスを計算\n3. 問題箇所を特定\n4. 解析レポートを生成"
    },
    {
      "name": "/vb6-check-dependencies",
      "description": "VB6プロジェクトの依存関係を完全チェック",
      "pattern": "/vb6-check-dependencies",
      "action": "1. プロジェクトファイル(.vbp)から参照を抽出\n2. COMコンポーネントの登録状態確認\n3. DLL/OCXのバージョン情報取得\n4. 不足している依存関係をリスト化"
    },
    {
      "name": "/vb6-add-module",
      "description": "VB6プロジェクトに新しいモジュールを追加（※ファイルはSJISで保存）",
      "pattern": "/vb6-add-module <type> <name>",
      "parameters": {
        "type": "モジュールタイプ (bas/cls/frm)",
        "name": "モジュール名"
      },
      "action": "1. 指定されたタイプのモジュールテンプレートを作成\n2. プロジェクトファイルに参照を追加\n3. SJIS文字コードで保存",
      "encoding": "SJIS",
      "note": "VB6ソースファイルは必ずSJIS文字コードで読み書きします。"
    },
    {
      "name": "/vb6-add-error-handling",
      "description": "VB6プロシージャに包括的エラーハンドリングを追加",
      "pattern": "/vb6-add-error-handling <file> <procedure>",
      "parameters": {
        "file": "対象ファイルパス",
        "procedure": "プロシージャ名 (省略時は全プロシージャ)"
      },
      "action": "1. 指定されたプロシージャを検索\n2. 標準的なエラーハンドリングコードを挿入\n3. エラーログ出力処理を追加\n4. Exit Sub/Functionの適切な配置",
      "encoding": "SJIS"
    },
    {
      "name": "/vb6-create-dao",
      "description": "VB6 データアクセスオブジェクト(DAO)クラスを生成",
      "pattern": "/vb6-create-dao <entity>",
      "parameters": {
        "entity": "エンティティ名 (例: Customer, Order)"
      },
      "action": "1. DAOクラステンプレートを生成\n2. CRUD操作メソッドを実装\n3. エラーハンドリングを含む\n4. トランザクションサポート",
      "encoding": "SJIS"
    },
    {
      "name": "/vb6-create-project",
      "description": "新しいVB6プロジェクトを標準構造で作成",
      "pattern": "/vb6-create-project <name> <type>",
      "parameters": {
        "name": "プロジェクト名",
        "type": "プロジェクトタイプ (exe/dll/ocx)"
      },
      "action": "1. プロジェクトディレクトリ構造を作成\n2. 基本的な.vbpファイルを生成\n3. 標準モジュール・フォームを追加\n4. 必要な参照設定を追加"
    },
    {
      "name": "/vb6-optimize-db",
      "description": "VB6データベースアクセスコードを最適化",
      "pattern": "/vb6-optimize-db <file>",
      "parameters": {
        "file": "最適化対象ファイル"
      },
      "action": "1. データベースアクセスコードを分析\n2. N+1問題の検出\n3. 接続プーリングの実装提案\n4. パラメータ化クエリへの変換",
      "encoding": "SJIS"
    },
    {
      "name": "/vb6-convert-to-net",
      "description": "VB6コードを.NET Framework 4.0/4.8向けに変換準備",
      "pattern": "/vb6-convert-to-net <file>",
      "parameters": {
        "file": "変換対象のVB6ファイル"
      },
      "action": "1. VB6特有の構文を特定\n2. .NET非互換コードをマーク\n3. 変換に必要な修正提案を生成\n4. 移行ガイドラインを提供",
      "encoding": "SJIS"
    },
    {
      "name": "/vb6-create-unittest",
      "description": "VB6ユニットテストをVB6Unitフレームワークで生成",
      "pattern": "/vb6-create-unittest <class>",
      "parameters": {
        "class": "テスト対象クラス名"
      },
      "action": "1. VB6Unitフレームワーク用テストクラス生成\n2. 主要メソッドのテストケース作成\n3. セットアップ・ティアダウン実装\n4. アサーションメソッドの定義",
      "encoding": "SJIS"
    },
    {
      "name": "/vb6-add-com-reference",
      "description": "VB6プロジェクトにCOM参照を追加",
      "pattern": "/vb6-add-com-reference <project> <component>",
      "parameters": {
        "project": "プロジェクトファイル(.vbp)パス",
        "component": "COMコンポーネント名またはGUID"
      },
      "action": "1. 指定されたCOMコンポーネントを検索\n2. プロジェクトファイルに参照を追加\n3. 必要な依存関係も確認\n4. バージョン互換性をチェック"
    },
    {
      "name": "/vb6-generate-interface",
      "description": "VB6インターフェースクラスを生成",
      "pattern": "/vb6-generate-interface <name> <methods>",
      "parameters": {
        "name": "インターフェース名",
        "methods": "メソッド名リスト（カンマ区切り）"
      },
      "action": "1. インターフェースクラスを作成\n2. 指定されたメソッドのスタブを生成\n3. 実装クラスのテンプレートも作成\n4. Implements文の追加",
      "encoding": "SJIS"
    },
    {
      "name": "/vb6-create-form",
      "description": "VB6フォームを標準テンプレートで作成",
      "pattern": "/vb6-create-form <name> <type>",
      "parameters": {
        "name": "フォーム名",
        "type": "フォームタイプ (standard/mdi/child/dialog)"
      },
      "action": "1. 指定されたタイプのフォームを作成\n2. 基本的なコントロールを配置\n3. イベントハンドラのスタブを生成\n4. エラーハンドリングを含む",
      "encoding": "SJIS"
    },
    {
      "name": "/vb6-analyze-performance",
      "description": "VB6コードのパフォーマンス分析と最適化提案",
      "pattern": "/vb6-analyze-performance <file>",
      "parameters": {
        "file": "分析対象ファイル"
      },
      "action": "1. パフォーマンスボトルネックを特定\n2. 文字列連結の最適化提案\n3. ループ処理の改善点\n4. オブジェクト生成の最適化"
    },
    {
      "name": "/vb6-generate-report",
      "description": "VB6 Crystal Reportsレポートテンプレート生成",
      "pattern": "/vb6-generate-report <name> <datasource>",
      "parameters": {
        "name": "レポート名",
        "datasource": "データソース（テーブル/ビュー名）"
      },
      "action": "1. Crystal Reports連携コードを生成\n2. レポート表示フォームを作成\n3. パラメータ処理を実装\n4. エクスポート機能を追加"
    },
    {
      "name": "/vb6-create-installer",
      "description": "VB6アプリケーション用Inno Setupインストーラー作成",
      "pattern": "/vb6-create-installer <project>",
      "parameters": {
        "project": "プロジェクトファイル(.vbp)パス"
      },
      "action": "1. 依存ファイルリストを生成\n2. Inno Setupスクリプトを作成\n3. レジストリ設定を含む\n4. アンインストール処理も実装"
    },
    {
      "name": "/vb6-migration-assessment",
      "description": "VB6から.NETへの移行評価レポート作成",
      "pattern": "/vb6-migration-assessment <project>",
      "parameters": {
        "project": "プロジェクトディレクトリパス"
      },
      "action": "1. 移行難易度を評価\n2. 非互換機能をリストアップ\n3. 推定作業時間を算出\n4. 移行戦略を提案"
    },
    {
      "name": "/vb6-generate-documentation",
      "description": "VB6プロジェクトのドキュメント自動生成",
      "pattern": "/vb6-generate-documentation <project>",
      "parameters": {
        "project": "プロジェクトディレクトリパス"
      },
      "action": "1. クラス・モジュール一覧を作成\n2. メソッド・プロパティの説明を抽出\n3. 依存関係図を生成\n4. Markdown形式で出力"
    },
    {
      "name": "/vb6-refactor-to-patterns",
      "description": "VB6コードをデザインパターンにリファクタリング",
      "pattern": "/vb6-refactor-to-patterns <file> <pattern>",
      "parameters": {
        "file": "対象ファイル",
        "pattern": "適用パターン (singleton/factory/observer)"
      },
      "action": "1. 現在のコード構造を分析\n2. 指定パターンへの変換計画\n3. リファクタリング実行\n4. テストコードも更新",
      "encoding": "SJIS"
    },
    {
      "name": "/vb6-setup-ci",
      "description": "VB6プロジェクト用CI/CDパイプライン設定",
      "pattern": "/vb6-setup-ci <project> <platform>",
      "parameters": {
        "project": "プロジェクトファイル(.vbp)パス",
        "platform": "CIプラットフォーム (jenkins/azure-devops)"
      },
      "action": "1. ビルドスクリプトを生成\n2. テスト自動化設定\n3. デプロイメント設定\n4. パイプライン設定ファイル作成"
    },
    {
      "name": "/vb6-check-security",
      "description": "VB6コードのセキュリティ脆弱性チェック",
      "pattern": "/vb6-check-security <path>",
      "parameters": {
        "path": "チェック対象パス"
      },
      "action": "1. SQLインジェクション脆弱性検出\n2. ハードコードされた認証情報\n3. 安全でないファイル操作\n4. 修正提案の提供"
    },
    {
      "name": "/vb6-com-inventory",
      "description": "COM/ActiveXコンポーネント依存関係調査",
      "pattern": "/vb6-com-inventory <project_path>",
      "parameters": {
        "project_path": "VB6プロジェクトのパス"
      },
      "action": "1. プロジェクトが使用するCOMコンポーネントをリスト\n2. 各コンポーネントのバージョン情報\n3. レジストリ登録状態\n4. Registration-Free COMへの変換可能性"
    },
    {
      "name": "/vb6-api-usage-scan",
      "description": "Win32 API使用箇所の一覧化",
      "pattern": "/vb6-api-usage-scan <project_path>",
      "parameters": {
        "project_path": "VB6プロジェクトのパス"
      },
      "action": "1. Declare文を検索\n2. API関数の呼び出し箇所を特定\n3. DLL別にグルーピング\n4. .NETでの代替手段を提示"
    },
    {
      "name": "/vb6-database-extract",
      "description": "データベーススキーマ抽出",
      "pattern": "/vb6-database-extract <project_path>",
      "parameters": {
        "project_path": "VB6プロジェクトのパス"
      },
      "action": "1. 接続文字列を抽出\n2. 使用テーブル・ビューを特定\n3. ストアドプロシージャの使用状況\n4. ER図の生成"
    }
  ],
  "build_commands": [
    {
      "name": "/vb6-build",
      "description": "VB6プロジェクトをビルド",
      "pattern": "/vb6-build <project>",
      "parameters": {
        "project": "プロジェクトファイル(.vbp)パス"
      },
      "action": "VB6.exe /make \"{project}\" /out \"{log_file}\""
    },
    {
      "name": "/vb6-compile-check",
      "description": "VB6プロジェクトのコンパイルチェック",
      "pattern": "/vb6-compile-check",
      "action": "1. 現在の.vbpファイルを検出\n2. VB6コンパイラでビルド\n3. エラーを表示\n4. 修正提案を提供"
    }
  ]
}