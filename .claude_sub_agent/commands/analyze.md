# /analyze - 既存プロジェクト解析コマンド

## 概要
既存プロジェクトのソースコードを解析し、要件定義書と技術設計書を自動生成または更新します。
2回目以降の解析では、キャッシュを活用して70-80%の時間短縮を実現します。

## 使用方法

### 基本構文
```bash
/analyze <project-path> [options]
```

### オプション
- `--generate-docs` - 初回解析で設計書を生成
- `--use-cache` - キャッシュを活用した高速解析（デフォルト）
- `--force-refresh` - キャッシュを無視して完全再解析
- `--feature <name>` - 特定機能のみ解析
- `--diff-only` - 前回からの差分のみ解析

## 実行例

### 初回解析
```bash
/analyze "./my-project" --generate-docs
```

### 2回目以降の高速解析
```bash
/analyze "./my-project" --use-cache
```

### 特定機能の解析
```bash
/analyze "./my-project" --feature authentication
```

## 処理フロー

1. **プロジェクトスキャン**
   - ディレクトリ構造の把握
   - ファイルタイプの識別
   - 依存関係の検出

2. **コード解析**
   - 構文解析
   - アーキテクチャパターン認識
   - API仕様抽出

3. **ドキュメント生成**
   - 要件定義書の自動生成
   - 技術設計書の自動生成
   - チェックサム記録

4. **キャッシュ保存**
   - 解析結果の保存
   - ハッシュ値の記録
   - 次回解析の高速化準備

## 出力

### 生成される成果物
```
.claude_sub_agent/specs/existing/<project-name>/
├── requirements/
│   ├── current.md        # 現在の要件定義書
│   ├── checksums.json    # ファイルハッシュ
│   └── history/          # 変更履歴
├── design/
│   ├── current.md        # 現在の技術設計書
│   ├── architecture/     # アーキテクチャ図
│   ├── checksums.json    # ファイルハッシュ
│   └── history/          # 変更履歴
└── metadata.json         # プロジェクトメタデータ
```

## 要件定義書の内容
- システム概要
- 機能要件一覧
- 非機能要件
- API仕様
- データモデル
- 依存関係

## 技術設計書の内容
- アーキテクチャ概要
- モジュール構成
- クラス設計
- データフロー
- 技術スタック
- コード品質メトリクス

## パフォーマンス

| 解析タイプ | 所要時間 | 削減率 |
|-----------|---------|--------|
| 初回解析 | 100% | - |
| キャッシュ利用 | 20-30% | 70-80% |
| 差分のみ | 5-10% | 90-95% |

## 担当部門
- **主担当**: 🎯 CTO
- **副担当**: 💻 システム開発部
- **プロフェッショナル**: 📊 技術データアナリスト（Gemini-CLI連携時）

## 注意事項
- ソースコードが常に正（Single Source of Truth）
- 設計書は解析キャッシュとして機能
- 大規模プロジェクトの初回解析には時間がかかる場合があります
- バイナリファイルは解析対象外

## 関連コマンド
- `/sync-docs` - 設計書の同期
- `/validate-docs` - 整合性検証
- `/modify-request` - 修正要求分析